@{ 
    
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - خدوم</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    @*<link href="~/css/carousel.css" rel="stylesheet" />*@
    <link href="~/lib/bootstrap/dist/css/bootstrap-rtl.min.css" rel="stylesheet" />

    <meta property="og:title" content="@ViewData["Title"]" />
    <meta property="og:type" content="blog" />
    <meta property="og:image" content="@ViewData["Image"]" />
    <meta property="og:url" content="@ViewData["Url"]" />
    <meta property="og:site_name" content="@ViewData["SiteName"]" />


    @*<link href="~/css/theme1.css" rel="stylesheet" />*@
    <link href="~/css/theme2.css" rel="stylesheet" />
    @*<link href="~/css/theme3.css" rel="stylesheet" />*@
    <link rel="stylesheet" href="~/css/site.css" />
    <link href="https://fonts.googleapis.com/css?family=Cairo&display=swap" rel="stylesheet">
    @*<link href="https://fonts.googleapis.com/css?family=Almarai|Cairo&display=swap" rel="stylesheet">*@
    @*<link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />*@
    <style>
        .btn-blue {
            background-color: #512bd4;
            border-color: #512bd4;
            color: white;
        }

        .btn-color2 {
            background-color: #fd8204;
            border-color: #fd8204;
            color: white;
        }

            .btn-color2:hover {
                background-color: #ffa242;
                border-color: #ffa242;
                color: white;
            }

        .btn-outline-color2 {
            background-color: white;
            border-color: white;
            color: #fd8204;
        }

            .btn-outline-color2:hover {
                background-color: #fd8204;
                border-color: #fd8204;
                color: white;
            }

        .btn-blue:hover {
            background-color: #3c11d1;
            border-color: #3c11d1;
            color: white;
        }

        .bg-blue {
            background-color: #512bd4;
            border-color: #512bd4;
            color: white;
        }

        .btn-outline-blue {
            color: #512bd4;
            border-color: #512bd4;
            background-color: white
        }

            .btn-outline-blue:hover {
                color: white;
                border-color: #512bd4;
                background-color: #512bd4;
            }

        .text-blue {
            color: #512bd4;
        }

            .text-blue:hover {
                color: #3c11d1;
            }

        .text-whitee {
            color: #e0e0e0;
        }

            .text-whitee:hover {
                color: #fff;
            }

        .Lnk {
            color: #007eb2;
        }

            .Lnk:hover {
                text-decoration: none;
                color: #0098d0;
            }

        .iqlaa3-btn {
            background-color: white;
            color: #007eb2;
        }

            .iqlaa3-btn:hover {
                background-color: #007eb2;
                color: white;
            }

        .MainCategories {
            width: 100%;
        }

        .Category {
            width: 100%;
            background-color: transparent;
            height: 50px;
        }

        .CategoryImg img {
            width: 50px;
            height: 50px;
            border-radius: 120px;
            float: right
        }

        .CategoryTitle {
            height: 50px;
            padding-top: 15px;
            padding-right: 60px;
        }

        .CategoryLnk {
            color: #007eb2;
        }

            .CategoryLnk:hover {
                text-decoration: none;
                color: #0098d0;
            }

        .tbl-btn {
            width: 40px;
            height: 40px;
            text-align: center;
            border-radius: 0;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Cairo';
        }

        #OrderSection #BtnCartInfo {
            width: 85px;
            height: 85px;
            border-radius: 200px;
            position: fixed;
            bottom: 109px;
            right: 42%;
            background-color: rgb(0, 112, 205);
            color: white;
            z-index: 100;
        }

        .BtnCartInfoNotfcation {
            width: 40px;
            display: none;
            height: 40px;
            background-color: rgb(239, 15, 15);
            border-radius: 25px;
            text-align: center;
            padding: 7px;
            position: absolute;
            top: -20px;
            left: 1px;
            color: white;
        }

        #BtnCartInfo:hover {
            background-color: rgb(1, 139, 255);
        }
    </style>

    @* <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5fbe47317530e20012b5f03d&product=inline-share-buttons' async='async'></script>*@

</head>
<body style="font-family:'Cairo'; background-color: #f3f3f3">
    <!-- Load Facebook SDK for JavaScript -->
    <div id="fb-root"></div>
    <script>
        window.fbAsyncInit = function () {
            FB.init({
                xfbml: true,
                version: 'v9.0'
            });
        };

        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = 'https://connect.facebook.net/ar_AR/sdk/xfbml.customerchat.js';
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>

    <!-- Your Chat Plugin code -->
    <div class="fb-customerchat"
         attribution=setup_tool
         page_id="102745648330624"
         logged_in_greeting="أهلا بحضرتك ، ابعتلنا محتاج ايه ؟"
         logged_out_greeting="أهلا بحضرتك ، ابعتلنا محتاج ايه ؟">
    </div>

    <header>
        <nav style="background-color: #007eb2" class="navbar  navbar-expand-sm navbar-toggleable-sm    ">
            <div class="container">
                <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">
                    <img src="~/uploads/wslogo.png" width="150" height="75" alt="" loading="lazy">
                </a>
                @*<button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                            aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>*@
                <div class=" d-sm-inline-flex flex-sm-row-reverse">
                    @*<partial name="_LoginPartial" />*@
                    <ul class="navbar-nav">
                        <li style="margin-left: 10px;margin-bottom:10px" class="nav-item">
                            <a href="https://forms.gle/sDwtDnRLe2qSjGag8" target="_blank" class="btn btn-color2 text-white"><i class="fas fa-plus"></i> <span class="d-none d-lg-inline">اضف نشاطك</span> </a>
                        </li>
                        <li style="margin-left: 10px;margin-bottom:10px" class="nav-item">
                            <a href="#" id="FavoriteLink" onclick="GetFavorites()" class="btn btn-outline-color2"><i class="fas fa-heart"></i> <span class="d-none d-lg-inline">المفضلة</span> </a>
                        </li>
                        <li style="margin-left: 10px;margin-bottom:10px" class="nav-item">
                            <a href="tel:+2-010-646-416-08" class="btn btn-secondary"><i class="fas fa-phone"></i> <span class="d-none d-lg-inline">كلمنا موبايل</span> </a>
                        </li>
                        <li class="nav-item">
                            <a href="https://wa.me/201064641608" class="btn btn-info"><i class="fab fa-whatsapp"></i> <span class="d-none d-lg-inline">كلمنا واتس</span> </a>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    <div id="OrderSection">
        <form asp-action="OrderList" asp-controller="Home">
            <input type="hidden" class="UserPhone" name="UserPhone" />
            <input type="hidden" class="Password" name="Password" />
            <button type="submit" class="btn text-center" id="BtnCartInfo"><i style="font-size:25px" class="fas fa-cart-plus"></i> <span class="BtnCartInfoNotfcation">0</span></button>
        </form>
    </div>


    <footer class="border-top footer text-muted">
        <div class="container">
            خدوم - &copy; @DateTime.Now.Year - <a asp-area="" asp-controller="Home" asp-action="About">عن المنصة</a>
        </div>
    </footer>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>
    <script src="~/lib/jquery-ajax-unobtrusive/dist/jquery.unobtrusive-ajax.js"></script>
    <script src="~/js/tata.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="https://kit.fontawesome.com/ef95329904.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5ece7c650c8b6e5f"></script>
    <script src="~/js/caleandar.min.js"></script>
    @*<script src="//code.tidio.co/zq3epalba2ghwuf9u8apjfk8wzkktpo9.js" async></script>*@
<script>
        function AddToFavorite(id) {
            items = JSON.parse(localStorage.getItem("items") || "[]");
            if (!items.includes(id)) {
                items.push(id);
                localStorage.setItem("items", JSON.stringify(items));
                $("#btn" + id).removeClass("btn-dark");
                $("#btn" + id).addClass(" btn-danger");
            }
            else {
                var index = items.indexOf(id);
                items.splice(index, 1);
                localStorage.setItem("items", JSON.stringify(items));

                $("#btn" + id).removeClass("btn-danger");
                $("#btn" + id).addClass("btn-dark");

            }

            console.log(items);
        }

        function GetFavorites() {
            items = JSON.parse(localStorage.getItem("items") || "[]");
            $('#FavoriteLink').attr("href", `/home/Favorites/${items}`);
        }

        $(function () {

            //Favorits
            items = JSON.parse(localStorage.getItem("items") || "[]");

            $('#tbl button').each(function () {
                id = $(this).attr("name");
                if (items.includes(Number(id))) {
                    $("#btn" + id).attr("class", "btn btn-danger");
                }


            });

            //$('#ShareButtons').remove();
            //$('#ShareModal').append('<div id="ShareButtons" class="addthis_inline_share_toolbox"></div>');


            //add userphone and password to btn order list
            var UserPhone = localStorage["UserPhone"];
            var Password = localStorage["Password"];
            debugger;
            console.log(UserPhone);
            console.log(Password);
                if (UserPhone == null || UserPhone == "" && Password == null || Password == "") {
                    if ($("#Login").length == 0 ) {
                        //location.href = "/Home/ClientLogin";
                        //Get Cart Items Cont For this user
                    }
                }
                else {
                    $(".UserPhone").val(UserPhone);
                    $(".Password").val(Password);
                    GetCartItemsCount();
                }











        });

        //Fast user login functions
        function FastUserLogin() {

        }

        function GetCartItemsCount() {
            var UserPhone = localStorage["UserPhone"];
            var Password = localStorage["Password"];
            debugger;
            
            if (UserPhone == null || UserPhone == "" && Password == null || Password == "") {
                if ($("#Login").length == 0 ) {
                    //location.href = "/Home/ClientLogin";
                }
            }
            else {


                 $.ajax({
                    type: 'POST',
                    url: `@Url.Action("GetCartItemsCount", "Home")`,
                    data: {
                        UserPhone: UserPhone,
                        Password: Password
                    },
                     success: function (data) {
                         if (data.num > 0) {

                             $(".BtnCartInfoNotfcation").text(data.num);
                             $(".BtnCartInfoNotfcation").show();
                             //tata.success('عربة التسوق', 'تمت الاضافة', {
                             //    position: 'mm'
                             //})
                         }
                         else {
                             $(".BtnCartInfoNotfcation").hide();
                         }
                    },
                    error: function (ex) {
                        var r = jQuery.parseJSON(response.responseText);
                        alert("Message: " + r.Message);
                        alert("StackTrace: " + r.StackTrace);
                        alert("ExceptionType: " + r.ExceptionType);
                    }
                });
            }
        }

        $('.BtnAddToCart').click(function () {
            var UserPhone = localStorage["UserPhone"];
            var Password = localStorage["Password"];
            debugger;
            if (UserPhone == null || UserPhone == "" && Password == null || Password == "") {
                location.href = "/Home/ClientLogin";
            }
            else {
                var itm = $(this).parents(".card").attr("data-itm");
                var Quantity = Number($('#Quantity' + itm).val());

                 $.ajax({
                    type: 'POST',
                    url: `@Url.Action("AddToCart", "Home")`,
                    data: {
                        UserPhone: UserPhone,
                        Password: Password,
                        Quantity: Quantity,
                        ItemId: itm
                    },
                     success: function (data) {
                         console.log(data);
                         if (Number(data.num) > 0) {
                             $(".BtnCartInfoNotfcation").text(data.num);
                             $(".BtnCartInfoNotfcation").show();
                             $(".UserPhone").val(UserPhone);
                             $(".Password").val(Password);
                         }
                         else {
                             $(".BtnCartInfoNotfcation").hide();
                         }
                    },
                    error: function (ex) {
                        var r = jQuery.parseJSON(response.responseText);
                        alert("Message: " + r.Message);
                        alert("StackTrace: " + r.StackTrace);
                        alert("ExceptionType: " + r.ExceptionType);
                    }
                });
            }
        });




        //start item list partial view
        // start card order code
        function PlusQuantity(itm) {
            console.log(itm);
            var Quantity = Number($('#Quantity' + itm).val());
            var QuantityDuration = Number($('#QuantityDuration' + itm).val());

            var Price = Number($('#Price' + itm).val());
            var QuantityLabel = $('#lblQuantity' + itm);

            var TotalQuantity = Quantity + QuantityDuration;
            var TotalPrice = Price * TotalQuantity;

            $(QuantityLabel).text(TotalQuantity);
            $('#Quantity' + itm).val(TotalQuantity);

            var QuantityVal = $('#Quantity' + itm).val();

            console.log(QuantityVal.indexOf("."));
            if (QuantityVal.indexOf(".") == -1) {
                $('#Quantity' + itm).text(`${QuantityVal}.0`);
                $('#lblQuantity' + itm).text(`${QuantityVal}.0`);
            }

            $('#lblItmTotalPrice' + itm).text(`${TotalPrice}`);
            $('#BtnAddToCart' + itm).removeClass("btn-dark");
            $('#BtnAddToCart' + itm).addClass(" btn-danger");
        }

        function MinusQuantity(itm) {
            var Quantity = Number($('#Quantity' + itm).val());
            var QuantityDuration = Number($('#QuantityDuration' + itm).val());

            if (!Number($('#Quantity' + itm).val()) <= 0) {

                var Price = Number($('#Price' + itm).val());
                var QuantityLabel = $('#lblQuantity' + itm);

                var TotalQuantity = Quantity - QuantityDuration;
                var TotalPrice = Price * TotalQuantity;


                $(QuantityLabel).text(TotalQuantity);
                $('#Quantity' + itm).val(TotalQuantity);

                var QuantityVal = $('#Quantity' + itm).val();

                console.log(QuantityVal.indexOf("."));
                if (QuantityVal.indexOf(".") == -1) {
                    $('#Quantity' + itm).text(`${QuantityVal}.0`);
                    $('#lblQuantity' + itm).text(`${QuantityVal}.0`);
                    $('#lblItmTotalPrice' + itm).text(`${TotalPrice}`);
                }

                if (QuantityVal == 0) {
                    $('#BtnAddToCart' + itm).removeClass("btn-danger");
                    $('#BtnAddToCart' + itm).addClass(" btn-dark");
                }
            }
        }

        $('.BtnQuantityPlus').click(function () {
            var itm = $(this).parents(".card").attr("data-itm");
            PlusQuantity(itm)
        });

        $('.BtnQuantityMinus').click(function () {
            var itm = $(this).parents(".card").attr("data-itm");
            MinusQuantity(itm);
        });
            // start card order code

            // end item list partial view


</script>
    @RenderSection("Scripts", required: false)
</body>
</html>
